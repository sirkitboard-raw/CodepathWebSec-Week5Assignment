<?php

require_once('../private/initialize.php');

$ds_publicKey = "-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxU6OASohpOSmKCJhpEDN
LPMgj3QhrRQvYawwKhtYYMK4J598eMsq8p8Ava1DPodzJ5zvePYy2+uLcTWTNWsf
M7R5YDWT+H/6ZLnm6twjMBMADiXH4eUIoeqqe1o7cVivtJFYqY3C4CkWdG8Z+3b5
lb//AhGZbcgKUQmHtyVJHiep8lEP1+MiF7ZPzC+W8c3JO2SYAKLpm16u9c83VCOp
0egly0QuLIQo9f6T0YVO2WDZ+ZdKp7I9kFHRR88B0D51vYtgu9mW7e6VxrfOUgv7
IbOmtyldd8mJfUZbmh/Zy9fS25A9gt+JIAf74MhR5i+a2joiwgpk41naXSO53ayZ
UQIDAQAB
-----END PUBLIC KEY-----";

$ds_private = "-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDFTo4BKiGk5KYo
ImGkQM0s8yCPdCGtFC9hrDAqG1hgwrgnn3x4yyrynwC9rUM+h3MnnO949jLb64tx
NZM1ax8ztHlgNZP4f/pkuebq3CMwEwAOJcfh5Qih6qp7WjtxWK+0kVipjcLgKRZ0
bxn7dvmVv/8CEZltyApRCYe3JUkeJ6nyUQ/X4yIXtk/ML5bxzck7ZJgAoumbXq71
zzdUI6nR6CXLRC4shCj1/pPRhU7ZYNn5l0qnsj2QUdFHzwHQPnW9i2C72Zbt7pXG
t85SC/shs6a3KV13yYl9RluaH9nL19LbkD2C34kgB/vgyFHmL5raOiLCCmTjWdpd
I7ndrJlRAgMBAAECggEALdVpt2uKFTvoPTp/ZCCJiP+ReMGJcSNXPmE5bw6bIR8a
mFm8GHNZrrKxAV7WWBgu7+zM1FScy+mTouDHKYmQ3fn2mBraHMfd6rgkpDovEmPX
h3HPVPJXZwWURMNZO6NWbaO17O05b8kbpkCI0Jl6sQbAvkJIWfA2NUz5cdn/ejlj
eH7Pm35UsIbiSfqVevSXdeZ27ojqrJleft+/ZglRfgxDdSk3c3m66KPnbtSLh0tz
5mguuTcd+oK5ZfDQ0BblD3bcESwnLCoyEkQHakbSVios8ZDeJHYHF6zd6MjheIjj
puKwqPfkfchHwhkI+w4k6Ox4xKJba/hVRNdOLZvYYQKBgQD7ORz9+wLTegcjfG91
9cXMps0T9w6t5LROOIkciYQ04LXnV93OhazviVX6ITvEroxqLqKtRSAYwo0N8+vT
RvOnL2r2GpIJbgmzf18X90QZ9xJ/EWS7T93hMPcqvGbPUzV7xA0TpDm8qfbgZRj7
l66VRtUR43tRcciYBKkE3njCCwKBgQDJDv3azbWo5qvDO8JKUysOkJdMzF96tnaI
sGOYNJ23RfwBWky8h3oGqzt/8s9aE9fhb0aWoqQMj+Aj57FLTy69OqfSwFnXngEp
57tKXCfaONAvp/URLvru9kgaCVQ+giVL7htRfi8w2wOyPrtkf1ngMZKBt36HTBtC
qYVIn0CnkwKBgQDt1lNRTDuPtJ5fhSYM2iJqLpxGw4XdMYFV8IY2Qyar3PW50GDI
bZucpzuDc8Ue3lVHDWGrgp7xcfaSeBQSUMDJzcWIuvz4+nkqu3JuwQRzRIr5S6E/
CEy6Ll5B0l3O+CrRQnlS2A5lQ8/a/ztYrXB2GLoNlnygTYWoDflqB6jxowKBgHoT
kC76GAKljETOU/ms5cfCIxuOO6rWfsIf11jjGZ/d7lUj7tPJrl2+OjJFy4B16+4F
EmcD+XdnJECovQ1s1oQuyRc9k09HsI0xFpbfvZLSTBWjdTkpvVK6Vqz4XR5XBy5D
NHMWmrCfSm8/h6hNatSlRL9eGoUrwKGJLFQb3bXhAoGBAPT5QtnSG93HuCKVUb0r
Ki/yFF5sCo6UQ8oSjRjSBYbVs6EG6JIwglZilCuSdOaqQJQCMgbwAmSzEMtjH0a0
zYnr6xBsyVjH06nrnP0u9o/1Xv4DjWVfHv0LXAgyKY+p47Z1BLWACiLmChpaWuDw
46pu661IpQZ55WKph85Ie0j/
-----END PRIVATE KEY-----";

$friend_public = "-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsnwYcO+K1z9rSVwwgGup
poZbzmpFebstIvzDvL1dy+ouZE0IyOO1ffbs64vYRJhCcf9ipHA9IdXQfSNphI66
n/yaM9BYBoZmsw+6KfOCugCC8xgUprMdHEdbqrws42D/Da37fmVwDQzI0FIVAwCi
Pj4XepmYWGOgCpW/sK9KS3EaSrjirw03D2Joe4J5BECxz66bbaSmS8p9K/T7D7VF
io/loluXwb0awdRTbTtpIQC3rp83jid3St8s8C4M/kGvNkCaw2EtuJsNObjKhR6+
BhqFz0RkR4NqIdVhfcHpSjXB6l8NzDxlqUzrUNOpGOzgt1Z5FMyBRbCY0biDDL12
jQIDAQAB
-----END PUBLIC KEY-----";

$emails = [
	[
		"message" => "gc1UwIgcysMktPryfVo5uxK81WfZTYK0XZnyef49oKQmIsQHsqdDgw4tmnfAIwf3qKd8eVRllJ/9jZ1iVF/+RTOO5AkVEb0SnM1Ez9vOclB8C/8LQ0Ov6W/l7xnuSEr/7zf0bklYDtIBNxWMSqBmQ4fIyUb3RslddicUCH8q6PSWPkSymZM/YeoKaLfaMHhUrC8a5/TKWB7szHuyn9kNrpCju/CH5F9U9jyPNIGyeL94guYBL6SUulHREL02QKg+J/pmkbsduB9zwbUKeRRqGIdnl5F/nQxwIZ7LvQcRJe5n2k+FI8ycmO746R9HWzi6ve+aIHAWs8USkbOqMvohXQ==",
		"signature" => "KGMoQjiyBsopZA8sWKrtcms4tyLrEZhd/bYEFCa/0Igqyg29w+keIwPFrJZ5CLXcPMbsoCOfGVv92p09uI+Sr6jkGwdOO/yIo5sBq3B7oQOs6uUFTFEUOmWQd5GtP/nz8lgolthM8TA1ADLyQk2Om1+NdzHVofZ7ZwEpPAluKAa0VOV5aaYxetqtFoC8H7CAA9sT0y9ncxrZdk3Q4YToKwDfG8yka0rNHYs+wyqv0UrGA873q6QPIXVWoB/eQNo1vAJhr/vznoiL05xYmBut3vE6NHe56cfiD9i+ESfWlBdwb5if2BII1zfJAvFfiLHn0eLi78umzgB9rByjZeONyA=="
	],
	[
		"message" => "eSsV3OCfikKEI6QTPgkBBBIchH/LzyAU33Zq3cUPrGcTX3oTmDBKl5A+BiHclFVU4EwY4uE0coL0ES7YqOxvGO1pJBL8wpOcLvX1KIgRpycrPqJh3TtNqTWzTfzxPMtQdSmiUXKe/U/nNUaoOF7OvHSmnGe2NQT43GyR/cczUElspgA3UZZS4SDsvGAiUjpyzsC8pE+AGDFZNeqJ475ydC7ABBwNWJDvxFq0t5bePF/O1s1I5dfur9SA7AeHvHN0sk05rWOO9KrEMBmEs5pxTCTTRWWuHlCGqeCTsmy09N1+A7MgWzoey2ImMgebdaT+omgM3P5wloO3eq9dlWWdag==",
		"signature" => "tCIgMXFS6Vg8LQFm5zb7AEBH1tcJmgSSmiC/hJeglJBRlCEyGHbdzrrbGlWXd7RdnRv9C7RJxcFwKSonN/p33qMgzDFoPMoO0KjV+wsc7YCbxtUEp6WM+nKPR3z+S/s/C9c/UhxV71V3pOndkpaWC7t7xm+DyAISVxSAj/ADkw9DheN4KkYyHjuOCX4kxtKFqVhKF6UTJfvZ5xisuxqajjT//9I7RSRPp/Vxu5oEIsolaO8sgjr3RHgeS5y8WLZ/iVakvvu8UWqd1qnmnd7bQodP78rssU7emq77m2wldWExaWJzrYZJxFwmFnn0otoRk9je1HLzaG+dI9DtxYs54w=="
	],
	[
		"message" => "J6nSdoddChP0cGd6OtsbLquIYLcFZ2zaEqmlR273WDAeX23bI0Obk8J5W/i0LqIrR6Bh8QPxss59cWBpzoudKWk/sONXPwChX5QATyu14NvmPID0kBUVce3seKYd0ge9vkEsVZBuUsnvtzIgzkNi3g1KyxJQOTczNI59JKfZUGHfhLFmrJGgoXG1HsNB7AGyQzQzhJmFin3yTx8MXM4+bWIDNCWiNQfGmfkW6qsFOxeOM2FRWnMM9Okuy6a3digBS6+xbmHeguVyMwFOaRzIzjuYCcjvahM+sa1Bm3prJeMG2Nwz5yvlm7kkQugzxC7EtRJSHJwlt5nkVblaRkiHew==",
		"signature" => "BlLBfHMS4SleyXQFbZT1xCQ1M3EM/AUoNYvYKafLRdRVKhEYZHgPl//oE75TrppcfjUnY1TDopBrKvMV061m/cJFpKjM8BwxmRb4GuVIcwNmlwc2Vb2+b3ZFRwCBQ7Fmbv9RxmV4F2uMdlZIMhjoEvgspwbzttF/1qtQyZqeD4inxIZV5Mc4anJoyWZnuuQcffLmhdpe0iDulRrafXHxrRYts0Fn+LYxyEPwdvxJu/uyxHpFg0hZ1D82duUrwPSm6p/eV32SYk0X491X7OPc5ZcUm4xKUZfLG15pk70exOTJnawWqI39BhLeoJJe6l3WRGqMynMqA8Ei8X4mvVA9vg=="
	],
	[
		"message" => "dTaaCJE/OOGzWO4t05FqJcfi4U5gX7Kvb3rc2+0Fc9p7iloCaFyQFGk6RzLNgf5bBSb/fMiU/dK68xuNAWAY8oanSM7m3swhvaSOIfigTsMsdFevjrYvomhbdtSXGumfLhb23bhNH8Hqesl554jiKZ2Qhc0b07IED3b16VFCrmXAvvVKaU0Mcr3lPx/Tlw5fscAwyhuEFIG+4SZsaVlphh2ML8tkLT1FOCgmouwMS1i4WsNMPYShKTpeq1bUFKFun9RUFdNQjkD9H5NPFmQvycOmAMSQKY1i+QNtLZs48oi4jKX9xWv9UUu9bCYHmHz07WiVcXB2I1pFfwX+VP5ETg==",
		"signature" => "CnTqxdkLagI9n3BtzmIPjmvedjHLVoVkpT7Ok1H5sIvvrGuKZdy7dvSVPMj3vJQYND3uRQImGwOOqPjV892X14oT4V6ZA/VgxkN9Texb/RsyZYrs0x5qSiQuOw1oRqI61KQ1Hn2CCBz7k68czoFGMB/YUBZ72yj2Fo07h+Qjw6qmY+UhHalmNq1Ye6t0x+v2U7TlNxkmVoWN30ETA5WKua3uMRQzp5VOT2GVyYSsm4iAqCz/51SM3S7SRPsrtvYpsAvOhdaq++fHQOjlZPqkOEJUtJcN4t7bkM5Ftf92w9KhiRHr5WqPGMrPfo2syo/s5F2pUkj9AHiIuzikmODZTw=="
	],
	[
		"message" => "qs1GuW93x5gkvQMOg0dLD7LFdUvZc1ymE0kwGVjeXZ7hfj5vXevFn457GUJLDJpQW8YMMUcr9GaYF+DojfPVOkTpXLK+B6rJTZbUt3s4fY5TwZ02Ao4uM653HEmWqF+ZkIwBK1gb/R62S33/C9tsGsCkDTE3MWk0y4uJ5ma5+czh+xZ6/RDz+0Z8Jw4EoRgB2C5hASZds+Or3ayO2XQnQg6ZHROehrJBzia+lL0/wZwNYxH/1HlExvrruyAmxmmncR4g3Fk36aLx1qabuxQN2gGl3eGewD6pjSeo1vt6VBQbEmH5t75IWi/Z0+HWZr8CIxe35zWK+ntKeF0O+O0zgw==",
		"signature" => "mFFnjjUhITlQa83o0EwWRLWDsMxgIxFGTdEvmkviAUE9lvltBrp77VW8Yi1Ko4izwcL0Q6rUqW3O0kNK50b7tVK4ZbwSQtXjEakhu1VUegZkBuTIFhKMxWUse3okRdZxOKxsRQC0wL2zTD+maC8ayKaKM9EYz4/r+aXFC10KjtVXVA4qNazzzYFaG801XxbiSYsemTkKnOsOrtGTtYox7UbD3XpR1IXsDDwthpc00ZyKJqoNtTk32Dxq59JzsJ5nDKs+En8H5Sa8lQagyUWZGNN21PIx4pHHrA/WnMSjOllvqPhcxb4MeHQh+3e3f4GYBYvOMU7RLQCdiCGMeh93NQ=="
	],
	[
		"message" => "wS8XsgTeYMmNwDrMSe+x2ndvDyllC6x+wzEL57XI8AkNkAbJLMztOFR7A/A36mzedd5lbmS9i3JsLTv49sPWPr+U/rdbkaTOxtCVsi6CovRd1r6swSJQyHlVAuTw1tkFvfAmff9cJZT0N/mgF2YjQrxczKcbb3evHxZdH8qcNYmc6kF+vRBcZASlYXK8lsl14cVUDBPbW1Bt25i0dV9Eikl97vmrydYrf9Dh7KelgoamQmSi3T1a9Empn4o+Op94PfBUgkSt8yDNTEelNzAzLDTJW795+qYsQivCQzF+BbhbRmkmcXr6ExXbteKoixqC6s2DmBNJ7m9wR5VlFXmXdA==",
		"signature" => "PLFoWBng/TjNjR+9LBOOvKKGs5X/0Ge+qGmM314JIy0nhSpScPqVsctUHNTY615GXis2XMEsxsuKEag06oR9V+yo1djAQ6pf7sAFab4Zxu86DzvPIb10wc1p048TOL1HSL1++ssmD+/EJw8MxJwzLu+cwYnhz0pWgdOaGJrnjRtaWbnbB1cDOxfoi/O5mggFywi9bTG2KliWE3RarPA6LXxx5WrYpijIN9U58gGLnf0wAAE5cQtGZBeb7Xi52ELpP3LXANxHIvRhMbKN4JsqmkeRrRtZEuBsul3MItxZnsoZ0rsHctogn88DkeWiZrI+ALpf/eZ1Pn4WMbRMBG58LA=="
	],
];

foreach($emails as $email) {
	print_r(pkey_decrypt($email['message'], $ds_private));
	echo '<br/>';
	print_r(verify_signature($email['message'],$email['signature'], $friend_public));
	echo '<br/>';
}